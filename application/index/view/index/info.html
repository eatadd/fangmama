<extend name="base/common"/>

<block name="body">
    <style>
        .el-header {
            color: #333;
            line-height: 60px;
            text-align: right;
            font-size: 12px;
            position: fixed;
            top: 0;
            z-index: 100;
        }

        .el-aside {
            color: #333;
        }

        #menu {
            position: absolute;
        }

        .el-menu {
            box-shadow: 0 0 5px #ddd;
            z-index: 99;
            border: 1px solid #ddd;
        }

        .el-menu-item {
            color: #555;
            border-bottom: 1px solid #f3f3f3;
        }

        .el-menu-item:focus, .el-menu-item:hover {
            background-color: #e6e9ed;
            color: #ff5100
        }

        a {
            text-decoration: none
        }

        .el-menu li {
            height: 35px;
            line-height: 35px;
        }

        .buliding_home_name {
            color: #999;
            margin-right: 10px;
        }

        .build_border_size {
            font-size: 0.9rem;
            color: #999;
        }

        .bulid_newtim_col {
            padding: 5px 0px;
        }

        .bulid_info_tow_tit > h3 {
            display: inline-block;
        }

        .bulid_info_tow_tit {
            display: flex;
            align-items: center;
        }

        .bulid_info_tow_tit > span {
            background-color: #FF5501;
            width: 4px;
            display: inline-block;
            height: 20px;
            margin-right: 10px;
        }

        .build_info_two {
            padding-top: 10px;
        }

        .build_ifo_two_news {
            padding: 0 13px;
        }

        .build_ifo_two_news_dv {
            font-size: 0.9rem;
            line-height: 2;
        }

        .build_ifo_two_news_dv > span:first-child {
            color: #999;
            padding-right: 15px;
        }

        .build_house_ypp_img {
            width: 100%;
            /*height: 260px;*/
        }

        .build_three_neararea {
            padding: 10px 0;
        }

        .build_three_area {
            padding: 5px 0;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .build_three_area > span:first-child {
            color: #999;
            padding-right: 15px;
        }

        #allmap {
            width: 100%;
            height: 500px;
            overflow: hidden;
            margin: 0;
            font-family: "微软雅黑";
        }

        .building_diolg_up {
            padding-left: 50px;
        }

        .building_diolg_soan {
            min-height: 2.5rem;
            line-height: 2.5rem;
            display: block;
        }

        /*2019/10/14 狸猫修改公海详情页面样式*/
        .share_house_selling {
            background-color: #FF5501;
            color: #fff;
            padding: 8px 2px 8px 5px;
            text-align: center;
            width: 95px;
            font-size: 0.75rem;
        }

        .share_house_three_row {
            padding: 10px 13px;
        }

        .share_house_pic {
            line-height: 28px;
            margin: 0;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .share_house_info_test {
            display: flex;
            align-items: center;
            min-height: 60px;
        }

        .share_house_selling_btn {
            background-color: #FF5501;
            color: #fff;
            padding: 8px 0px 8px 0px;
            text-align: center;
            /*width: 90px;*/
            font-size: 0.8rem;
            cursor: pointer;
        }

        .el-table td, .el-table th.is-leaf {
            text-align: center;
        }

        .index_info_titimg {
            width: 50px;
            height: 50px;
            overflow: hidden;
            border-radius: 50%;
        }

        .index_prop_tu {
            background-color: rgba(111, 121, 111, .05);
        }
    </style>
    <div id="app" v-hide>
        <el-container>
            <el-container v-loading="loading">
                <el-header style="width: 100%;background-color: white">
                    <el-row>
                        <el-col :span="5" style="text-align: left">
                            <!--修改按钮-->
                            <el-button type="primary" icon="el-icon-arrow-left" size="small" @click="open">
                            </el-button>
                        </el-col>

                        <!--修改按钮-->
                        <el-button type="primary" icon="el-icon-copy-document" size="small" @click="HousingResources_share">
                        </el-button>
                        <el-button type="primary" icon="el-icon-share" size="small" @click="QRcode_share">
                        </el-button>
                    </el-row>
                </el-header>
                <el-main
                        @row-contextmenu.prevent="openDetails"
                        @row-dblclick="row_clicks"
                        :data="tableData"
                        style="margin-top: 60px;">

                    <!--轮播图-->
                    <template>
                        <el-carousel class="index_prop_tu" trigger="click" height="400px" interval="3000">
                            <el-carousel-item v-for="item in tableData.house_resold.show_images" :key="item"
                                              style="text-align: center">
                                <img :src="item" height="100%"
                                     width="auto"/>
                            </el-carousel-item>
                        </el-carousel>
                    </template>
                    <!--第一部分信息-->
                    <div class="" style="margin-top: 20px;">
                        <el-row style="padding: 5px 0">
                            <el-col :span="16">
                                <div class="grid-content bg-purple ">
                                    <span class="buliding_home_name">房源标题 :</span> {{tableData.house_resold.title}}
                                </div>
                            </el-col>
                            <el-col :span="18"><br>
                                <div class="grid-content bg-purple-light build_ifo_two_news_dv">
                                    <span>房源标签</span>
                                    <span>
                                            <template v-for="item in tableData.house_resold.feature">
                                                <el-tag style="margin-right: 10px">{{item || '暂无标签'}}</el-tag>
                                            </template>
                                        </span>
                                </div>
                            </el-col>
                            <el-col :span="5">
                                <div class="grid-content bg-purple-light" style="color:red;">
                                    <span style="font-size: 1rem;">{{tableData.house_resold.unit_price}}</span> 元 /
                                    <span style="font-size: 1.1rem;">{{square}}</span>
                                </div>
                            </el-col>
                        </el-row>

                        <el-row :gutter="20" class="share_house_info_test" style="font-size: 0.9rem;">
                            <el-col :span="16">
                                <div class="grid-content bg-purple">
                                    小区: <i class="el-icon-location-outline"></i> {{tableData.house_index_str}}
                                </div>
                            </el-col>
                            <el-col :span="8">

                            </el-col>
                        </el-row>

                        <el-row class="build_border_size bulid_newtim_right">
                            <el-col :span="12" class="bulid_newtim_col">
                                <div class="grid-content bg-purple">
                                    创建时间: {{tableData.create_time}}
                                </div>
                            </el-col>
                            <el-col :span="12" class="bulid_newtim_col">
                                <div class="grid-content bg-purple">
                                    更新时间: {{tableData.house_resold.update_time}}
                                </div>
                            </el-col>
                            <el-col :span="12" class="bulid_newtim_col">
                                <div class="grid-content bg-purple">
                                    浏览次数: {{tableData.house_resold.view_count}}次
                                </div>
                            </el-col>
                        </el-row>
                    </div>
                    <!--2019/10/17新增经纪人列表页面-->
                    <div class="build_info_new_person">
                        <div class="bulid_info_tow_tit">
                            <span></span>
                            <h3>经纪人</h3>
                        </div>
                        <el-table :data="tableData.house_share_user" style="width: 100%"
                                  @cell-mouse-enter="handledbClick"
                                  @row-dblclick="handledbClick_row">
                            </el-table-column>

                            <el-table-column
                                    label="头像"

                            >
                                <template slot-scope="scope">
                                    <img class="index_info_titimg" :src="scope.row.user_profile_info.logo"
                                         style="cursor: pointer;" @click="details_btn()">
                                    <div>{{scope.row.user_profile_info.nickname}}</div>
                                </template>

                            </el-table-column>
                            <el-table-column
                                    prop="store.title"
                                    label="所属门店"
                            >
                            </el-table-column>
                            <el-table-column
                                    prop="user.mobile"
                                    label="手机号">
                            </el-table-column>
                            <el-table-column
                                    prop="store_user_info.deal_rate"
                                    label="成交率">
                            </el-table-column>
                            <el-table-column
                                    prop="store_user_info.deal_num"
                                    label="合作次数">
                            </el-table-column>
                            <el-table-column
                                    prop="store_user_info.deal_finish"
                                    label="成交套数">
                            </el-table-column>
                            <el-table-column
                                    prop="store_user_info.deal_score"
                                    label="成交评价">
                            </el-table-column>
                            <el-table-column
                                    prop=""
                                    label="">
                                <div class="share_house_selling_btn" @click="handleClick()">
                                    请求合作
                                </div>
                            </el-table-column>
                            <el-table-column
                                    prop=""
                                    label="">
                                <template slot-scope="scope">
                                    <div class="share_house_selling_btn" @click="addRoom(scope.row)">
                                        与他沟通
                                    </div>
                                </template>
                            </el-table-column>
                        </el-table>
                    </div>

                    <!--第二部分-->
                    <div class="build_info_two">
                        <div class="bulid_info_tow_tit">
                            <span></span>
                            <h3>房源简介</h3>
                        </div>
                        <div class="build_ifo_two_news">
                            <el-row>
                                <el-col :span="12">
                                    <div class="grid-content bg-purple build_ifo_two_news_dv">
                                        <span>{{price_house}}</span>
                                        <span>{{tableData.house_resold.id}}{{price_house_}}</span>
                                    </div>
                                </el-col>
                                <!--<el-col :span="12">-->
                                <!--<div class="grid-content bg-purple-light build_ifo_two_news_dv">-->
                                <!--<span>所属财产</span> <span>{{tableData.house_resold.price}}</span>-->
                                <!--</div>-->
                                <!--</el-col>-->
                            </el-row>
                            <el-row>
                                <el-col :span="12">
                                    <div class="grid-content bg-purple build_ifo_two_news_dv">
                                        <span>房屋风格</span> <span>{{tableData.house_resold.style}}</span>
                                    </div>
                                </el-col>
                                <el-col :span="12">
                                    <div class="grid-content bg-purple-light build_ifo_two_news_dv">
                                        <span>装修情况</span> <span>{{tableData.house_resold.decoration}}</span>
                                    </div>
                                </el-col>
                            </el-row>
                            <el-row>
                                <el-col :span="12">
                                    <div class="grid-content bg-purple build_ifo_two_news_dv">
                                        <span>房本面积</span> <span>{{tableData.house_resold.house_size}}/㎡</span>
                                    </div>
                                </el-col>
                                <el-col :span="12">
                                    <div class="grid-content bg-purple-light build_ifo_two_news_dv">
                                        <span>房源产权</span> <span>{{tableData.house_resold.house_property}}</span>
                                    </div>
                                </el-col>
                            </el-row>
                            <el-row>
                                <el-col :span="12">
                                    <div class="grid-content bg-purple build_ifo_two_news_dv">
                                        <span>所在楼层</span> <span>{{tableData.house_resold.house_floor}}层</span>
                                    </div>
                                </el-col>
                            </el-row>
                        </div>
                        <div class="build_ifo_two_news" v-if="type__ == 1">
                            <el-row>
                                <el-col :span="12">
                                    <div class="grid-content bg-purple build_ifo_two_news_dv">
                                        <span>房源押金</span> <span>{{tableData.house_resold.cash_pledge}}</span>
                                    </div>
                                </el-col>
                                </el-col>
                                <el-col :span="12">
                                    <div class="grid-content bg-purple-light build_ifo_two_news_dv">
                                        <span>最短租期</span> <span>{{tableData.house_resold.shortest_lease}}</span>
                                    </div>
                                </el-col>
                                <el-col :span="12">
                                    <div class="grid-content bg-purple-light build_ifo_two_news_dv">
                                        <span>房源朝向</span> <span>{{tableData.house_resold.direction}}</span>
                                    </div>
                                </el-col>
                                <el-col :span="12">
                                    <div class="grid-content bg-purple-light build_ifo_two_news_dv">
                                        <span>房源类型</span> <span>{{tableData.house_resold.house_type}}</span>
                                    </div>
                                </el-col>
                                <el-col :span="12">
                                    <div class="grid-content bg-purple-light build_ifo_two_news_dv">
                                        <span>房源电梯</span> <span>{{tableData.house_resold.elevator}}</span>
                                    </div>
                                </el-col>
                            </el-row>
                        </div>
                    </div>

                    <!--第三部分 楼盘简介及配置描述-->
                    <div class="build_info_two">
                        <div class="bulid_info_tow_tit">
                            <span></span>
                            <h3>房源配置及描述</h3>
                        </div>
                        <el-row :gutter="20" class="share_house_three_row">
                            <el-col :span="4">
                                <div class="grid-content bg-purple">

                                    <div class="share_house_selling">
                                        {{characteristic}} <i class="el-icon-caret-top"></i>
                                    </div>

                                </div>
                            </el-col>
                            <el-col :span="20">
                                <div class="grid-content bg-purple">
                                    <p class="share_house_pic">
                                        【户型】 {{tableData.house_resold.house_config_param || '暂无数据'}}<br>
                                        【面积】{{tableData.house_resold.house_size}}平<br>
                                        【学区房】临近{{tableData.house_resold.near_school}}学校<br>
                                        【装修】{{tableData.house_resold.decoration}}<br>
                                    </p>
                                </div>
                            </el-col>

                        </el-row>
                        <el-row :gutter="20" class="share_house_three_row">
                            <el-col :span="4">
                                <div class="grid-content bg-purple">
                                    <div class="share_house_selling">
                                        服务介绍 <i class="el-icon-caret-top"></i>
                                    </div>

                                </div>
                            </el-col>
                            <el-col :span="20">
                                <div class="grid-content bg-purple">

                                    <p class="share_house_pic" v-if="house_type_id == 1">
                                        {{tableData.house_resold.house_intro}}
                                    </p>
                                    <p class="share_house_pic" v-if="house_type_id == 2 || house_type_id == 3">
                                        {{tableData.house_resold.desc}}
                                    </p>
                                </div>
                            </el-col>

                        </el-row>

                    </div>

                    <!--第四段户型图内容-->
                    <div class="build_info_four" v-if="this.tableData.lat != 0 && this.tableData.lng != 0"
                         style="padding-bottom: 40px;">
                        <div class="bulid_info_tow_tit">
                            <span></span>
                            <h3>附近周边</h3>
                        </div>
                        <!--地图展示-->
                        <div id="allmap"></div>
                    </div>
                </el-main>
            </el-container>
        </el-container>


        <el-dialog
                title="二维码"
                :visible.sync="QRcode_dialogVisible"
                width="30%">
            <div class="fl_erweima" style="text-align: center;height: 220px"></div>
        </el-dialog>
    </div>
    <input type="text" style="display: none;" id="inputShare" value="">
</block>
<block name="js">
    <!--2019/10/11 狸猫新增地图js引入-->
    <script type="text/javascript" src="//api.map.baidu.com/api?v=2.0&ak=cOrtbdRp4rHUoUKiSDR81w8XjDLLwEdb"></script>
    <script src="/js/jquery-2.0.3.min.js"></script>
    <script src="/js/jquery.qrcode.min.js"></script>
    <script type="text/javascript">
        // 传参 详情页面中点击弹出聊天的功能，完成度0.1%
        function Parent_level(room_id) {

        }
        let house_share_id_url = "{:input('house_share_id')}";
        let page_go = "{:input('house_share_id')}";
        page_go = page_go.split(',');
        let url = page_go[0];
        let page = page_go[1];
        let user_data = JSON.parse('{:cache("user_data")}');
        let clickTimer = null;
        var myvue = new Vue({
            el: '#app',
            data: {
                //租房房租
                square: '㎡',
                //核心卖点
                characteristic: '核心卖点',
                price_house: '房屋总价',
                price_house_: '万',
                //租房切换
                type__: 0,
                //轮播图片
                fileListss: [],
                fileLists: [],
                tableData: {
                    house_resold: {},
                    house_renting: {}
                },
                value: '',
                search: '',
                input2: '',
                show: false,
                drawer: false,
                direction: 'btt',
                formVisible: false,
                activeName: 'one',
                activeIndex: '1',
                activeIndex2: '1',
                customer: {id: ""},
                customer_id: 0,
                forms: [],
                formDom: {},
                form: {
                    name: '',
                    region: '',
                    date1: '',
                    date2: '',
                    delivery: false,
                    type: [],
                    resource: '',
                    desc: ''
                },
                loading: false,
                customerFollows: [],
                followOption: {},
                tabIndex: 0,
                formIndex: 0,
                datas: [],
                datasPage: 1,
                datasNextBtn: true,
                header: {user_token: user_data.user_token.user_token, store_id: user_data.store_user_info.store_id},
                page: 1,
                nextBtn: true,
                formLabelWidth: '120px',
                dialogImageUrl: '',
                dialogVisible: false,
                videoVisible: false,
                videosrc: '',
                store_user_id: '',
                house_share_id: '',
                store_id: '',
                house_type_id: '',


                QRcode_dialogVisible:false,
            },
            created() {
                this.info();
            },
            methods: {
                QRcode_share(row){
                    this.QRcode_dialogVisible = true;
                    let url = utils.domain+'/home/index/JointSale_share.html?house_share_id='+house_share_id_url || '';

                    $('.fl_erweima').html('');
                    setTimeout(function () {
                        $('.fl_erweima').qrcode({
                            render: "canvas", //table方式
                            width: 200, //宽度
                            height:200, //高度
                            text: url //任意内容
                        });
                    });
                },
                HousingResources_share(row){
                    console.log(row);
                    let url = utils.domain+'/home/index/JointSale_share.html?house_share_id='+house_share_id_url+'&other_user='+user_data.store_user_info.user_id;
                    document.execCommand("Copy"); // 执行浏览器复制命令
                    var oInput = document.getElementById("inputShare");
                    oInput.style.display = "block";
                    oInput.value = url;
                    oInput.select(); // 选择对象
                    document.execCommand("Copy"); // 执行浏览器复制命令
                    oInput.style.display = "none";
                    this.$message({
                        message: '复制链接成功',
                        type: 'success'
                    });
                },
                // 分享
                JointSale_share(){

                },
                //双击事件
                handledbClick_row() {
                    utils.ajax({
                        data: {
                            url: 'extend/manager/house_share/switchInfo',
                            // user_token: user_data.user_token.user_token,
                            // store_id: user_data.store_user_info.store_id,
                            store_user_id: this.store_user_id,
                            house_share_id: this.house_share_id,
                            store_id: this.store_id,
                            house_type_id: this.house_type_id
                        },
                        success: (res) => {
                            if (res.data.code == -2) {
                                this.$message.error(res.data.msg);
                                return false;
                            }
                            if (res.data.code == 1) {
                                this.$message.success(res.data.msg);
                                // console.log(res);
                                let data = res.data.data;

                                // this.tableData = data;
                                if (this.house_type_id == 1) {
                                    // console.log('1' + JSON.stringify(data));
                                    this.tableData.house_resold.title = data.houseNew.title;
                                    this.tableData.price = data.houseNew.price;
                                    this.tableData.house_index_str = data.houseNew.house_index_str;
                                    this.tableData.create_time = data.houseNew.create_time;
                                    this.tableData.is_share = data.houseNew.is_share;
                                    this.tableData.title = data.houseNew.title;
                                    this.tableData.house_resold.style = data.houseNew.style;
                                    this.tableData.house_resold.decoration = data.houseNew.decoration;
                                    this.tableData.house_resold.house_intro = data.houseNew.title;
                                    this.tableData.house_resold.house_size = data.houseNew.house_size;
                                    this.tableData.house_resold.desc = data.houseNew.house_intro;
                                } else if (this.house_type_id == 2) {
                                    // console.log('2' + JSON.stringify(data));
                                    this.tableData.house_resold.title = data.houseResold.title;
                                    this.tableData.price = data.houseResold.price;
                                    this.tableData.house_index_str = data.houseResold.house_index_str;
                                    this.tableData.create_time = data.houseResold.create_time;
                                    this.tableData.is_share = data.houseResold.is_share;
                                    this.tableData.title = data.houseResold.title;
                                    this.tableData.house_resold.style = data.houseResold.style;
                                    this.tableData.house_resold.decoration = data.houseResold.decoration;
                                    this.tableData.house_resold.house_intro = data.houseResold.title;
                                    this.tableData.house_resold.house_size = data.houseResold.house_size;
                                } else if (this.house_type_id == 3) {
                                    // console.log('3' + JSON.stringify(data));
                                    this.tableData.house_resold.title = data.houseRenting.title;
                                    this.tableData.price = data.houseRenting.price;
                                    this.tableData.house_index_str = data.houseRenting.house_index_str;
                                    this.tableData.create_time = data.houseRenting.create_time;
                                    this.tableData.is_share = data.houseRenting.is_share;
                                    this.tableData.title = data.houseRenting.title;
                                    this.tableData.house_resold.style = data.houseRenting.style;
                                    this.tableData.house_resold.decoration = data.houseRenting.decoration;
                                    this.tableData.house_resold.house_intro = data.houseRenting.title;
                                    this.tableData.house_resold.house_size = data.houseRenting.house_size;
                                    this.tableData.house_resold.desc = data.houseRenting.desc;
                                }
                                this.tableData.house_index_str = this.tableData.house_index_str.split('-')[0];
                            }
                            if (res.data.code == 0) {
                                this.$message(res.data.msg);
                            }
                        },
                        error: (res) => {
                            console.log('error' + res)
                        }
                    })
                },
                //鼠标移入事件，显示对应经纪人的房源资料
                handledbClick(row) {
                    this.store_user_id = row.store_user_id;
                    this.house_share_id = row.house_share_id;
                    this.house_type_id = row.house_type_id;
                    // alert(this.house_type_id);
                    this.store_id = row.store_id;
                    console.log(this.store_user_id + "---" + this.house_share_id + '---' + this.store_id + '---' + this.house_type_id);
                },
                info() {
                    this.loading = true;
                    let data = Object.assign({
                        url: 'extend/manager/house_share/info',
                        house_share_id: url,
                        house_type_id: page_go[2]
                    }, this.header);
                    utils.ajax({
                        data: data,
                        success: (res) => {
                            this.loading = false;
                            // console.log(JSON.stringify(res.data.data));
                            if (res.data.code == -2) {
                                this.$message.error(res.data.msg);
                                return false;
                            } else if (res.data.code == 1) {
                                let data = res.data.data;
                                // console.log(res.data.data)
                                // console.log(JSON.stringify(data));
                                data.house_index_str = res.data.data.house_index_str.split('-')[0];
                                if (page_go[2] == 2) {
                                    this.tableData = data;
                                    this.tableData.house_resold = data.house_resold;
                                } else if (page_go[2] == 1) {
                                    this.tableData = data;
                                    this.tableData.house_resold = data.house_new;
                                } else if (page_go[2] == 3) {
                                    this.type__ = 1;
                                    this.square = '月';
                                    this.price_house = '房屋租价';
                                    this.price_house_ = '元/月';
                                    this.characteristic = '房源特色';
                                    this.tableData = data;
                                    // console.log(JSON.stringify(this.tableData));
                                    if (data.house_renting.elevator == 0) {
                                        data.house_renting.elevator = "未知";
                                    } else if (data.house_renting.elevator == 1) {
                                        data.house_renting.elevator = '有';
                                    } else {
                                        data.house_renting.elevator = '无';
                                    }
                                    this.tableData.house_resold = data.house_renting;
                                    this.tableData.house_resold.unit_price = data.house_renting.price;
                                }
                                data.house_resold.show_images = data.house_resold.show_images.split(',');
                                data.house_resold.feature = data.house_resold.feature.split(",");
                                data.house_resold.show_images.forEach(function (item, key) {
                                    data.house_resold.show_images[key] = (item.substr(0, 4).toLowerCase() == 'http') ? item : utils.img_domain + item;
                                });
                                let house_config_param = this.tableData.house_resold.house_config_param.split(',');
                                this.tableData.house_resold.house_config_param = house_config_param[0] + '室' + house_config_param[1] + '厅' + house_config_param[2] + '厨' + house_config_param[3] + '卫';
                                // this.tableData.house_resold.house_config_param = this.tableData.house_resold.house_config_param.replace(/,/g, '-');
                                let order_house_share = res.data.data.house_share_user;
                                for (let i = 0; i < order_house_share.length; i++) {
                                    //这里的内容是详情打开如果经纪人没有头像 显示一个默认的头像图片
                                    order_house_share[i].user_profile_info.logo = order_house_share[i].user_profile_info.logo || '';
                                    // order_house_share[i].status =  order_house_share[i].status || '';
                                    if (order_house_share[i].user_profile_info.logo == '') {
                                        order_house_share[i].user_profile_info.logo = '/images/xiaochu.jpg'
                                    }
                                }
                            }
                            this.house_map();
                        },
                        error: function (res) {
                            console.log('error' + res)
                        }
                    });

                    this.formDom = this.forms[this.formIndex];
                },
                //点击编辑图标显示弹窗修改内容
                open() {
                    window.location.href = '{:url("index")}?return_=' + page + ',' + page_go[2];
                },
                openDetails(row, column, event) {
                    event.preventDefault();
                    row.id = row.id || 0;
                    if (row.id == 0) {
                        this.$message.error('数据异常');
                        return;
                    }
                    // this.show = this.show ? false : true;
                    this.show = true;
                    var menu = document.querySelector("#menu");
                    menu.style.left = event.clientX + 'px';
                    menu.style.top = event.clientY + 'px';
                },
                row_clicks(row, event) {
                    if (clickTimer) {
                        window.clearTimeout(clickTimer);
                        clickTimer = null;
                    }
                    // 确定选中的客源
                    let customer = Object.assign({}, row);
                    this.customer = customer;
                    // your click process code here
                    this.dialogFormVisible = true;

                    this.getTabDataList();
                },
                //点击请求合作显示
                handleClick() {
                    let house_type_id = this.house_type_id;
                    this.$confirm('确认合作？')
                        .then(_ => {
                            utils.ajax({
                                data: {
                                    url: 'extend/manager/order_house_share/add',
                                    user_token: user_data.user_token.user_token,
                                    store_user_id: this.store_user_id,
                                    house_share_id: this.house_share_id,
                                    house_type_id: this.house_type_id
                                },
                                success: (res) => {
                                    // console.log(JSON.stringify((res)));
                                    if (res.data.code == -2) {
                                        this.$message.error(res.data.msg);
                                        return false;
                                    }
                                    if (res.data.code == 1) {
                                        this.$message.success(res.data.msg);
                                        setTimeout(function () {
                                            window.top.postMessage({
                                                type: 5,
                                                data: {
                                                    url: 'union_deal/lists?house_type_id=' + house_type_id
                                                }
                                            }, '*');
                                        }, 1000)
                                    }
                                    if (res.data.code == 0) {
                                        this.$message.error(res.data.msg);
                                    }
                                },
                                error: (res) => {
                                    console.log('error' + res)
                                }
                            })
                        })
                        .catch(_ => {
                        });
                },
                // 聊天接口
                addRoom(row) {
                    let room_user = [user_data.store_user_info.user_id, row.user.id];
                    let data = Object.assign({
                        url: 'extend/manager/Room/addRoom',
                        is_group: 0,
                        room_user: room_user.join(','),
                        logo: row.user_profile_info.logo,
                        title: row.user_profile_info.nickname,
                        number: room_user.length,
                    }, this.header);
                    utils.ajax({
                        data: data,
                        success: (res) => {
                            console.log(res);
                            // alert(JSON.stringify(res))
                            if (res.data.code == 1 || res.data.msg == '会话已经存在') {
                                let title = '{"room_id":"' + res.data.room_id + '","nickname":"' + row.user_profile_info.nickname + '","logo":"' + row.user_profile_info.logo + '","send_type":"1"}';


                                window.top.postMessage({
                                    type: 3,
                                    data: {
                                        room_id: res.data.room_id,
                                        title: title
                                    }
                                }, '*');
                            } else if (res.data.code == -2 || res.data.code == 0) {
                                this.$message.error(res.data.msg);
                                return false;
                            }
                        },
                        error: function (res) {
                            console.log('error' + res)
                        }
                    });
                },


                //查看详情
                details_btn() {
                    window.location.href = 'person_homepage.html?text=' + this.store_user_id + ',' + this.house_type_id + ',' + this.house_type_id;
                },
                //房源地图方法
                house_map() {
                    // 百度地图API功能
                    var map = new BMap.Map("allmap");    // 创建Map实例
                    map.centerAndZoom(new BMap.Point(this.tableData.house_resold.lng, this.tableData.house_resold.lat), 11);  // 初始化地图,设置中心点坐标和地图级别
                    console.log('map', this.tableData.house_resold.lat);
                    //添加地图类型控件
                    map.addControl(new BMap.MapTypeControl({
                        mapTypes: [
                            BMAP_NORMAL_MAP,
                            BMAP_HYBRID_MAP
                        ]
                    }));
                    map.setCurrentCity("宿迁");          // 设置地图显示的城市 此项是必须设置的
                    map.enableScrollWheelZoom(true);     //开启鼠标滚轮缩放
                }
            },
            // 过滤器
            filters: {
                statusFilterType(status) {
                    const statusMap = {'1': '有意向', '2': '看房', '3': '前订购协议', '4': '签合同', '5': '付款'};
                    return statusMap[status];
                },
            }
        });
    </script>
</block>
